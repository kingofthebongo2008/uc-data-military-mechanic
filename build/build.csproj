<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.props" Condition="Exists('packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.props')" />
  <Import Project="packages\uc-tools-model.1.0.19\build\native\uc-tools-model.props" Condition="Exists('packages\uc-tools-model.1.0.19\build\native\uc-tools-model.props')" />
  <Import Project="packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.props" Condition="Exists('packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.props')" />
  <PropertyGroup>
    <TargetFramework>native</TargetFramework>
  </PropertyGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <PropertyGroup>
    <AutoGeneratedAnimations Condition="$(AutoGeneratedAnimations) == ''">$(MSBuildThisFileDirectory)..\bin\animations\</AutoGeneratedAnimations>
    <AutoGeneratedModels Condition="$(AutoGeneratedModels) == ''">$(MSBuildThisFileDirectory)..\bin\models\</AutoGeneratedModels>
    <AutoGeneratedSkeletons Condition="$(AutoGeneratedSkeletons) == ''">$(MSBuildThisFileDirectory)..\bin\skeletons\</AutoGeneratedSkeletons>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <Animation>
      <InputAnimation>%(FullPath)</InputAnimation>
      <OutputAnimation>$(AutoGeneratedAnimations)%(FileName).animation</OutputAnimation>
      <Outputs>$(AutoGeneratedAnimations)%(FileName).animation</Outputs>
    </Animation>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup>
    <Model>
      <InputModel>%(FullPath)</InputModel>
      <OutputModel>$(AutoGeneratedModels)%(FileName).derivatives_skinned_model.model</OutputModel>
      <Type>derivatives_skinned_model</Type>
    </Model>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup>
    <SkinnedMultiMaterialModel>
      <InputModel>%(FullPath)</InputModel>
      <OutputModel>$(AutoGeneratedModels)%(FileName).derivatives_skinned_multi_material_model.model</OutputModel>
      <Type>derivatives_skinned_multi_material_model</Type>
    </SkinnedMultiMaterialModel>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup>
    <Skeleton>
      <InputSkeleton>%(FullPath)</InputSkeleton>
      <OutputSkeleton>$(AutoGeneratedSkeletons)%(FileName).skeleton</OutputSkeleton>
    </Skeleton>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup>
    <Texture>
      <InputTexture>%(FullPath)</InputTexture>
      <Format>bc1_unorm_srgb</Format>
    </Texture>
  </ItemDefinitionGroup>
  <Target Name="AnimationMakeDir">
    <ItemGroup Condition="'@(Animation)'!=''">
      <Outputs Include="@(Animation-&gt;Metadata('OutputAnimation')-&gt;Distinct())" />
      <DirsToMake Include="@(Outputs-&gt;DirectoryName())" />
    </ItemGroup>
    <MakeDir Directories="@(DirsToMake)" />
    <ItemGroup>
      <DirsToMake Remove="@(DirsToMake)" />
    </ItemGroup>
  </Target>
  <Target Name="ModelMakeDir">
    <ItemGroup Condition="'@(Model)'!=''">
      <Outputs Include="@(Model-&gt;Metadata('OutputModel')-&gt;Distinct())" />
      <DirsToMake Include="@(Outputs-&gt;DirectoryName())" />
    </ItemGroup>
    <MakeDir Directories="@(DirsToMake)" />
    <ItemGroup>
      <DirsToMake Remove="@(DirsToMake)" />
    </ItemGroup>
  </Target>
  <Target Name="SkeletonMakeDir">
    <ItemGroup Condition="'@(Model)'!=''">
      <Outputs Include="@(Skeleton-&gt;Metadata('OutputSkeleton')-&gt;Distinct())" />
      <DirsToMake Include="@(Outputs-&gt;DirectoryName())" />
    </ItemGroup>
    <MakeDir Directories="@(DirsToMake)" />
    <ItemGroup>
      <DirsToMake Remove="@(DirsToMake)" />
    </ItemGroup>
  </Target>
  <Target Name="BuildAnimations" DependsOnTargets="AnimationMakeDir" Inputs="@(Animation)" Condition="'@(Animation)' != ''" Outputs="%(Animation.OutputAnimation)">
    <Exec Command="$(UCToolsAnimation) --input_animation %(Animation.InputAnimation) --output_animation %(Animation.OutputAnimation)" />
  </Target>
  <Target Name="BuildModels" DependsOnTargets="ModelMakeDir" Inputs="@(Model);@(Texture)" Condition="'@(Model)' != ''" Outputs="%(Model.OutputModel)">
    <Exec Command="$(UCToolsModel) --type %(Model.Type) --input_model %(Model.InputModel) --output_model %(Model.OutputModel) @(Texture->'--textures %(FullPath)',' ') @(Texture->'--textures_format %(Format)',' ')" />
  </Target>
  <Target Name="BuildSkinnedMultiMaterialModels" DependsOnTargets="ModelMakeDir" Inputs="@(SkinnedMultiMaterialModel)" Condition="'@(SkinnedMultiMaterialModel)' != ''" Outputs="%(SkinnedMultiMaterialModel.OutputModel)">
    <Exec Command="$(UCToolsModel) --type %(SkinnedMultiMaterialModel.Type) --input_model %(SkinnedMultiMaterialModel.InputModel) --output_model %(SkinnedMultiMaterialModel.OutputModel)" />
  </Target>
  <Target Name="BuildSkeletons" DependsOnTargets="SkeletonMakeDir" Inputs="@(Skeleton);@(Texture)" Condition="'@(Skeleton)' != ''" Outputs="%(Skeleton.OutputSkeleton)">
    <Exec Command="$(UCToolsSkeleton) --input_skeleton %(Skeleton.InputSkeleton) --output_skeleton %(Skeleton.OutputSkeleton)" />
  </Target>
  <ItemGroup>
    <Animation Include="$(MSBuildThisFileDirectory)..\source\military_mechanic.fbx" />
  </ItemGroup>
  <ItemGroup>
    <Texture Include="$(MSBuildThisFileDirectory)..\source\cloth.png" />
    <Texture Include="$(MSBuildThisFileDirectory)..\source\body.png" />
    <Texture Include="$(MSBuildThisFileDirectory)..\source\face.png" />
    <Texture Include="$(MSBuildThisFileDirectory)..\source\eyelashes.png" />
    <Texture Include="$(MSBuildThisFileDirectory)..\source\eyes.png" />
  </ItemGroup>
  <ItemGroup>
    <Model Include="$(MSBuildThisFileDirectory)..\source\military_mechanic.fbx" />
  </ItemGroup>
  <ItemGroup>
    <SkinnedMultiMaterialModel Include="$(MSBuildThisFileDirectory)..\source\military_mechanic.fbx" />
  </ItemGroup>
  <ItemGroup>
    <Skeleton Include="$(MSBuildThisFileDirectory)..\source\military_mechanic.fbx" />
  </ItemGroup>
  <ItemGroup>
    <Reference Include="Compressonator_MD_DLL">
      <HintPath>packages\uc-tools-model.1.0.19\lib\native\Compressonator_MD_DLL.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="libfbxsdk">
      <HintPath>packages\uc-tools-skeleton.1.0.22\lib\native\libfbxsdk.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="lzham_x64">
      <HintPath>packages\uc-tools-skeleton.1.0.22\lib\native\lzham_x64.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="uc-animation">
      <HintPath>packages\uc-tools-animation.1.0.12\lib\native\uc-animation.exe</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="uc-model">
      <HintPath>packages\uc-tools-model.1.0.19\lib\native\uc-model.exe</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="uc-skeleton">
      <HintPath>packages\uc-tools-skeleton.1.0.22\lib\native\uc-skeleton.exe</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <Target Name="Build" DependsOnTargets="BuildAnimations;BuildModels;BuildSkeletons;BuildSkinnedMultiMaterialModels">
  </Target>
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Enable NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105.The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.props')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.props'))" />
    <Error Condition="!Exists('packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.targets')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.targets'))" />
    <Error Condition="!Exists('packages\uc-tools-model.1.0.19\build\native\uc-tools-model.props')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-model.1.0.19\build\native\uc-tools-model.props'))" />
    <Error Condition="!Exists('packages\uc-tools-model.1.0.19\build\native\uc-tools-model.targets')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-model.1.0.19\build\native\uc-tools-model.targets'))" />
    <Error Condition="!Exists('packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.props')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.props'))" />
    <Error Condition="!Exists('packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.targets')" Text="$([System.String]::Format('$(ErrorText)', 'packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.targets'))" />
  </Target>
  <Import Project="packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.targets" Condition="Exists('packages\uc-tools-animation.1.0.12\build\native\uc-tools-animation.targets')" />
  <Import Project="packages\uc-tools-model.1.0.19\build\native\uc-tools-model.targets" Condition="Exists('packages\uc-tools-model.1.0.19\build\native\uc-tools-model.targets')" />
  <Import Project="packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.targets" Condition="Exists('packages\uc-tools-skeleton.1.0.22\build\native\uc-tools-skeleton.targets')" />
</Project>